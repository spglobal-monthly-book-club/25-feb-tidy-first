## CHAPTER 16. 코드 정리 구분

- 코드 정리는 별도의 PR로 만들고, 가급적 PR당 몇 개의 코드 정리만 넣자.
- 코드 정리를 하다보면 기하급수적으로 수정된 코드의 양이 늘어나는 것을 볼 수 있다.
- 일단 동작(B) 과 구조(S)로 나눠보자. 이 과정이 지나면 공통 흐름이 파악된다.
- 변경 사항을 나누어 별도의 PR로 만들자. (B와 S 구분)
- 작은 PR은 검토 시간이 짧다. 그리고 초점이 분명해진다.
- 나중에 코드 정리에 익숙해지고, 작은 단위로 작업하고, 절대적으로 안전하게 작업하는데 익숙해지면 코드 정리 PR을 검토하지 말자.

![B와S](B와S.jpg)

## CHAPTER 17. 연쇄적인 정리

- 코드를 계속 정리하고 싶은 충동을 관리하는 것도 코드 정리의 핵심 기술이다.
- 먼저 아주 작은 단계로 나누어 코드를 정리하는 방식을 고수하자.
- 그러면서 각 단계를 최적화 하자.
- 그 뒤에는 어떤 정리를 해야하는지 명확히 보일 것이다.

- PART 1에서 배운 코드 정리 방법들을 하나씩 적용해보자.
- 보호 구문, 안 쓰는 코드 정리, 대칭으로 맞추기, 새로운 인터페이스 만들어서 적용, 읽는 순서로 배치, 응집도를 높이는 배치, 설명하는 변수, 설명하는 상수, 명시적인 매개변수, 비슷한 코드끼리, 도우미 추출, 하나의 더미, 설명하는 주석, 불필요한 주석 지우기

- 중복된 주석만 삭제하자. 오직 필요한 내용만 주석으로 쓰자.
- 너무 많이, 너무 빠르게 변경하지 않도록 주의하세요.

## CHAPTER 18. 코드 정리의 일괄 처리량

- 코드 정리 개수를 늘려서 동작 변경에 소용되는 비용을 줄이자. 그럼 검토 비용을 줄일 수 있다.

![코드 정리의 일괄 처리량 그래프](<코드 정리의 일괄 처리량.jpg>)

- 코드 정리 ⬆️ -> 검토하기 쉬움 -> 검토 비용 ⬇️ 충돌, 상호작용, 추측 ⬆️ 
- 코드 정리 ⬇️ -> 검토하기 어려움 -> 검토 비용 ⬆️ 충돌, 상호작용, 추측 ⬇️

- 코드 정리 갯수 늘리기 -> 검토 쉬워짐 -> 검토비용 ⬇️ 충돌, 상호작용, 추측 ⬇️ (보라색 그래프)

## CHAPTER 19. 리듬

- 코드 정리를 관리하는 기술 중에는 정리의 리듬을 관리하는 일도 있다.
- 코드 정리를 너무 길게 하지 말자. 코드 정리를 한번 하면 그것을 계속 쓰게 된다.
- 코드 정리는 몇 분에서 한 시간 정도면 충분하다.

## CHAPTER 20. 얽힘 풀기 (코드 정리와 동작변경의 순서)

- 상황

```

변경 대상인 동작을 모두 알게되었고, 그 동작들을 쉽게 변경하려면, 어떤 코드를 정리해야 하는지 모두 알게 되었으나, 정리한 코드와 변경할 동작이 함께 얽혀버렸다.

```

=> 진행 중인 작업을 버리고, 코드 정리를 선행하는 순서로 다시 시작하자. 이렇게 하면 작업은 더 많아지지만, 이어지는 커밋과의 일관성은 분명해진다.

- 코드의 얽힘을 먼저 풀자. 그러면 작업 량 자체가 적어질 것이다.

## CHAPTER 21. 코드 정리 시점 (언제 코드 정리를 할까?)

- 코드 정리를 하지 말아야 할때
    - 앞으로 다시는 코드를 변경하지 않을 때
    - 설계를 개선하더라도 배울 것이 없을 때

- 나중으로 코드 정리를 미룰 때
    - 정리할 코드 분량이 많은데, 보상이 바로 보이지 않을 때
    - 코드 정리에 대한 보상이 잠재적일 때
    - 작은 묶음으로 여러 번에 나눠서 코드 정리를 할 수 있을 때

- 동작 변경 후 정리할 때
    - 다음 코드 정리까지 기다릴 수록 비용이 더 불어날 때
    - 코드 정리를 하지 않으면 일을 끝냈다는 느낌이 들지 않을 때

- 코드 정리 후 동작 변경을 할 때
    - 코드 정리를 했을 때, 코드 이해가 쉬워지거나 동작 변경이 쉬워지는 즉각적인 효과를 얻을 수 있을 때
    - 어떤 코드를 어떻게 정리해야 하는지 알고 있을 때

